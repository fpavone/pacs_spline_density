#include <iostream>
#include <Eigen/Dense>
using namespace std;
using namespace Eigen;
int main()
{
   Matrix<double,9,9> A;
   Matrix<double,9,1> b;
   A << 479.799,2.67355,-1.81922,0.151329,-0.00911559,0,0,0,-480.795
   ,2.67355,13.683,1.03587,-0.194535,0.00429928,-2.65759e-06,0,0,-17.2022
   ,-1.81922,1.03587,1.20318,-0.0517574,-6.56325e-05,-0.000233588,-2.40237e-06,0,-0.367777
   ,0.151329,-0.194535,-0.0517574,0.0948988,0.00141182,-0.000648983,-0.000138166,-6.23065e-06,-0.000553995
   ,-0.00911559,0.00429928,-6.56325e-05,0.00141182,0.00329372,0.000408383,-0.000123245,-0.000108642,-9.02253e-08
   ,0,-2.65759e-06,-0.000233588,-0.000648983,0.000408383,0.00064477,4.29638e-05,-0.000210708,-1.803e-07
   ,0,0,-2.40237e-06,-0.000138166,-0.000123245,4.29638e-05,0.000118537,0.000100407,1.90525e-06
   ,0,0,0,-6.23065e-06,-0.000108642,-0.000210708,0.000100407,0.0119169,-0.0116918
   ,-480.795,-17.2022,-0.367777,-0.000553995,-9.02253e-08,-1.803e-07,1.90525e-06,-0.0116918,498.377;
   b << -43.0225,  -7.65193,  -1.31364,-0.0628141
,0.127919
 ,0.0743269
, 0.0353407
,    0.1002
,   51.7131;
   cout << "Here is the matrix A:\n" << A << endl;
   cout << "Here is the vector b:\n" << b << endl;
   VectorXd x = A.colPivHouseholderQr().solve(b);
   cout << "The solution is:\n" << x << endl;
}
